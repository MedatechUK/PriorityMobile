ZPDA_ANSWERS_LOAD
ZPDA_CALLCANCEL
ZPDA_CLEANTABLE
ZPDA_DAYEND_LOAD
ZPDA_FLAGS_LOAD
ZPDA_IMP_TIME
ZPDA_KANBAN_PART
ZPDA_PART_LOAD
ZPDA_REPAIR_LOAD
ZPDA_SFDAYEND
ZPDA_SIG_LOAD
ZPDA_STATUS_LOAD
ZPDA_SURVEYSIGN
ZPDA_TIME_LOAD

TAKESINGLEENT	ZPDA_LOAD_ANSWERS	I
TAKESINGLEENT	ZPDA_LOAD_DAYEND	I
TAKESINGLEENT	ZPDA_LOAD_FLAGS	I
TAKESINGLEENT	ZPDA_LOAD_PART	I
TAKESINGLEENT	ZPDA_LOAD_REPAIR	I
TAKESINGLEENT	ZPDA_LOAD_SIG	I
TAKESINGLEENT	ZPDA_LOAD_STATUS	I
TAKESINGLEENT	ZPDA_LOAD_TIME	I

TAKESINGLEENT	ZPDA_LOAD_ANSWERS	P
TAKESINGLEENT	ZPDA_LOAD_DAYEND	P
TAKESINGLEENT	ZPDA_LOAD_FLAGS	P
TAKESINGLEENT	ZPDA_LOAD_PART	P
TAKESINGLEENT	ZPDA_LOAD_REPAIR	P
TAKESINGLEENT	ZPDA_LOAD_SIG	P
TAKESINGLEENT	ZPDA_LOAD_STATUS	P
TAKESINGLEENT	ZPDA_LOAD_TIME	P

TAKESINGLEENT	ZPDA_KANBAN_PART	F
TAKESINGLEENT	ZPDA_SFDAYEND	F
TAKESINGLEENT	ZPDA_ANSWER_FORM	F
TAKESINGLEENT	ZPDA_FORMSURVSIGN	F
TAKESINGLEENT	ZPDA_REPAIR_FORM	F
TAKESINGLEENT	ZPDA_REPAIR_SFORM	F



:ID = :LINE = :NOLD = :FIRST = 0;
:LOADED = :RT = '';
/* ITERATE THROUGH LOAD TABLE */
DECLARE Cur CURSOR FOR
SELECT RECORDTYPE, LINE, LOADED FROM
/********************** LOAD TABLE NAME*/
ZSFDC_COUNT_SORTED
/***************************************/
WHERE LINE > 0;
OPEN Cur;
LABEL 10;
FETCH Cur INTO :RT, :LINE, :LOADED;
GOTO 20 WHERE :RETVAL = 0;
SELECT 1 INTO :NOLD FROM DUMMY WHERE :LOADED <> 'Y';
GOTO 15 WHERE :RT <> '1' OR :FIRST = 0;
/* RECORD TYPE 1 */
/* LOADED */
GOSUB 300; /* DELETE LOADED FROM LOAD TABLE */
GOSUB 200; /* CLEAN UP LOADING ID */
GOSUB 100; /* GET A LOADING ID */
LABEL 15;
INSERT INTO ZSFDC_CLEANTABLE (LOADID,LINE) VALUES (:ID, :LINE);
SELECT 1 INTO :FIRST FROM DUMMY;
LOOP 10;
LABEL 20;
CLOSE Cur;
GOSUB 300; /* DELETE LOADED FROM LOAD TABLE */
GOSUB 200; /* CLEAN UP LOADING ID */
/************************
************************/
SUB 100;
/* GET A LOADING ID */
SELECT 0 + MAX(LOADID) + 1 INTO :ID FROM ZSFDC_CLEANTABLE;
INSERT INTO ZSFDC_CLEANTABLE (LOADID, LINE) VALUES (:ID, 0);
RETURN;
/**/
SUB 200;
/* CLEAN UP LOADING ID */
SELECT 0 INTO :NOLD FROM DUMMY;
DELETE FROM ZSFDC_CLEANTABLE WHERE LOADID = :ID;
RETURN;
SUB 300;
/* DELETE LOADED FROM LOAD TABLE */
GOTO 310 WHERE :NOLD = 1;
DELETE FROM
/********************** LOAD TABLE NAME*/
ZSFDC_COUNT_SORTED
/***************************************/
WHERE LINE IN
(
SELECT LINE FROM ZSFDC_CLEANTABLE
WHERE LOADID = :ID
AND LINE > 0
);
LABEL 310;
RETURN;
