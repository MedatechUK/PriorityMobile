<h1>The Priority Process Service</h1>
Priortity procedures cannot be run from the <a href="">IIS Web Serive</a>.
This is becuase processes spawned under IIS are always created in the local security context, regardless of how much you swear at it. Priority WINRUN uses a mapped path and so must be started in a network security context (usually domain\administrator unless you want to make your eyes bleed!). <br><br>
This is where the Priority Process Service comes in. The process service runs as a <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/ProcSVC/ProcSVC/ProcSVC.vb">Windows Service</a> and handles the running of procedures on Priority.<br><br> 
The Procedure service creates the security contexts and <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/ProcSVC/ProcSVC/mapdrive.vb">mapped drive letters</a> required by Priority. The service  listens for socket messages coming from the <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/priwebsvc/">IIS Web Service</a> on port 8022. The service will only accept inbound connection from the localhost, so the Process service MUST be installed on the same machine as the IIS.<br><br>
When the <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/priwebsvc/">IIS</a> receives data from the <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/PDAOnBoardData/">PDA</a> it <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/priwebsvc/App_Code/Service.vb">saves the data </a> into the load tables. Then it connects to the process service and sends a notification as to which Priority procedure should be run. Each communication is handled by an <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/ProcSVC/ProcSVC/">out of process thread</a> which actually runs the Procedure on Priority.<br><br>
The start-up parameters of the service are defined in the <a href="http://ntsa.redmartian.org/projects.cgi?codepage=/v13PDA/ProcSVC/ProcSVC/app.config">App.config file</a>. If the service is running on the Priority server set MapDrive to blank (MapDrive="") and specify the local path to priority in the UNC parameter.
